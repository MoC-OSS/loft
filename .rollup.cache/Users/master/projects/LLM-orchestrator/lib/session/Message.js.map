{"version":3,"file":"Message.js","sourceRoot":"","sources":["../../src/session/Message.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,EAAE,IAAI,IAAI,EAAE,MAAM,MAAM,CAAC;AAElC,OAAO,EAAE,YAAY,EAAE,MAAM,YAAY,CAAC;AAE1C,MAAM,CAAN,IAAY,WAGX;AAHD,WAAY,WAAW;IACrB,sCAAuB,CAAA;IACvB,sCAAuB,CAAA;AACzB,CAAC,EAHW,WAAW,KAAX,WAAW,QAGtB;AAED,MAAM,OAAO,OAAO;IAClB,EAAE,CAAS;IACX,MAAM,CAAuB;IAC7B,gBAAgB,CAAmC;IACnD,OAAO,CAAU;IACjB,IAAI,CAAU;IACd,4DAA4D;IAC5D,6BAA6B;IAC7B,IAAI,CAAmB;IACvB,gBAAgB,CAA+B;IAC/C,UAAU,CAAU;IACpB,SAAS,CAAU;IACnB,SAAS,CAAU;IAEnB,YAAY,GAaX;QACC,MAAM,SAAS,GAAG,YAAY,EAAE,CAAC;QAEjC,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,IAAI,IAAI,EAAE,CAAC;QAC3B,IAAI,CAAC,MAAM,GAAG,GAAG,CAAC,MAAM,IAAI,MAAM,CAAC;QACnC,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC;QAC3B,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;QACrB,0CAA0C;QAC1C,wBAAwB;QACxB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC;QAC3B,IAAI,CAAC,gBAAgB,GAAG,GAAG,CAAC,gBAAgB,IAAI,EAAE,CAAC;QACnD,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,IAAI,KAAK,CAAC;QAC1C,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,IAAI,SAAS,CAAC;QAC5C,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,IAAI,SAAS,CAAC;IAC9C,CAAC;IAED,MAAM;QACJ,OAAO;YACL,EAAE,EAAE,IAAI,CAAC,EAAE;YACX,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,qCAAqC;YACrC,mBAAmB;YACnB,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,SAAS,EAAE,IAAI,CAAC,SAAS;SAC1B,CAAC;IACJ,CAAC;IAED,qCAAqC;IAC9B,WAAW;QAChB,IAAI,IAAI,CAAC,UAAU,KAAK,IAAI;YAAE,OAAO,SAAS,CAAC;QAE/C,MAAM,OAAO,GAAG;YACd,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;SACxC,CAAC;QAEF,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,yBAAyB;IACvE,CAAC;CACF","sourcesContent":["import { v4 as uuid } from 'uuid';\nimport { PalmMessage } from '../@types';\nimport { getTimestamp } from '../helpers';\n\nexport enum MessageType {\n  INJECTION = 'injection',\n  EMBEDDING = 'embedding',\n}\n\nexport class Message implements Omit<PalmMessage, 'author'> {\n  id: string;\n  author: 'user' | 'assistant';\n  citationMetadata?: PalmMessage['citationMetadata'];\n  content?: string;\n  name?: string;\n  // function_call?: ChatCompletionRequestMessageFunctionCall;\n  // type?: MessageType | null;\n  tags?: string[] | null;\n  customProperties: Record<string, unknown> | {};\n  isArchived: boolean;\n  createdAt?: Number;\n  updatedAt?: Number;\n\n  constructor(msg: {\n    id?: Message['id'];\n    author: Message['author'];\n    citationMetadata?: Message['citationMetadata'];\n    content?: Message['content'];\n    name?: Message['name'];\n    // function_call?: Message['function_call'];\n    // type?: Message['type'];\n    tags?: Message['tags'];\n    customProperties?: Message['customProperties'];\n    isArchived?: Message['isArchived'];\n    createdAt?: Message['createdAt'];\n    updatedAt?: Message['updatedAt'];\n  }) {\n    const timestamp = getTimestamp();\n\n    this.id = msg.id || uuid();\n    this.author = msg.author || 'user';\n    this.content = msg.content;\n    this.name = msg.name;\n    // this.function_call = msg.function_call;\n    // this.type = msg.type;\n    this.tags = msg.tags || [];\n    this.customProperties = msg.customProperties || {};\n    this.isArchived = msg.isArchived || false;\n    this.createdAt = msg.createdAt || timestamp;\n    this.updatedAt = msg.updatedAt || timestamp;\n  }\n\n  toJSON(): Partial<Message> {\n    return {\n      id: this.id,\n      author: this.author,\n      citationMetadata: this.citationMetadata,\n      content: this.content,\n      name: this.name,\n      // function_call: this.function_call,\n      // type: this.type,\n      tags: this.tags,\n      customProperties: this.customProperties,\n      isArchived: this.isArchived,\n      createdAt: this.createdAt,\n      updatedAt: this.updatedAt,\n    };\n  }\n\n  //use to filter out additional fields\n  public formatToLLM(): PalmMessage | undefined {\n    if (this.isArchived === true) return undefined;\n\n    const message = {\n      author: this.author,\n      content: this.content,\n      citationMetadata: this.citationMetadata,\n    };\n\n    return JSON.parse(JSON.stringify(message)); //delete undefined fields\n  }\n}\n"]}